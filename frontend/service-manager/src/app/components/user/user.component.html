<div class="container mt-4">
    <h1 class="mb-4">Research Programs</h1>

    <div *ngIf="loading" class="text-center">Loading programs...</div>
    <div *ngIf="error" class="alert alert-danger">
        Error: {{ error }}
    </div>

    <table *ngIf="programs && programs.length > 0" class="table table-striped">
        <thead>
            <tr>
                <th>Program Name</th>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Principal Investigator</th>
                <th>Funding Amount</th>
                <th>Description</th>
                <th>Apply</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let program of programs">
                <td>{{ program.program_name }}</td>
                <td>{{ program.start_date }}</td>
                <td>{{ program.end_date }}</td>
                <td>{{ program.principal_investigator }}</td>
                <td>{{ program.funding_amount }}</td>
                <td>{{ program.program_description }}</td>
                <td>
                    <button class="btn btn-sm btn-success" (click)="applyProgram(program.program_id)">
                        Apply
                    </button>
                </td>
            </tr>
        </tbody>
    </table>

    <div *ngIf="programs && programs.length === 0 && !loading" class="text-center">
        No programs available.
    </div>
</div>


<div class="modal-content">
    <div class="modal-header">
        <h5 class="modal-title" id="applyModalLabel">Apply for Program: {{ selectedProgramName }}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <form>
            <div class="form-group">
                <label for="participant_name">Your Name</label>
                <input type="text" class="form-control" id="participant_name" name="participant_name" required />
                <!-- [(ngModel)]="applicationForm.participant_name"  -->
            </div>
            <div class="form-group">
                <label for="date_of_birth">Date of Birth</label>
                <input type="date" class="form-control" id="date_of_birth" name="date_of_birth" required />
                <!-- [(ngModel)]="applicationForm.date_of_birth" -->
            </div>
            <div class="form-group">
                <label for="gender">Gender</label>
                <select class="form-control" id="gender" name="gender" required>
                    <!-- [(ngModel)]="applicationForm.gender" -->
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label for="medical_history">Medical History</label>
                <textarea class="form-control" id="medical_history" name="medical_history" required></textarea>
                <!-- [(ngModel)]="applicationForm.medical_history"  -->
            </div>
            <div class="form-group">
                <label for="consent_form">Consent Form</label>
                <input type="file" class="form-control-file" id="consent_form" name="consent_form"
                    (change)="handleFileChange($event)" required />
                <small class="form-text text-muted">Upload a PDF or image of your signed consent form.</small>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="submitApplication()">Submit Application</button>
    </div>
</div>